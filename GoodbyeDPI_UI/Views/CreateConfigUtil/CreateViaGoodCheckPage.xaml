<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="CDPI_UI.Views.CreateConfigUtil.CreateViaGoodCheck"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CDPI_UI.Views.CreateConfigUtil"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:lcontrols="using:CDPI_UI"
    xmlns:conv="using:CDPI_UI.Converters"
    xmlns:l="using:WinUI3Localizer">

    <Page.Resources>
        <CubicEase x:Key="CubicEaseOut" EasingMode="EaseOut"/>
        <CubicEase x:Key="CubicEaseIn" EasingMode="EaseIn"/>
        <conv:BoolToVisibilityConverter x:Key="BoolToVis"/>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
        </Grid.RowDefinitions>

        <Grid x:Name="ContentGrid" Padding="20, 0, 20, 0">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <StackPanel x:Name="LoadingStackPanel" Grid.Row="1">
                <StackPanel.RenderTransform>
                    <TranslateTransform x:Name="Loading_TT" />
                </StackPanel.RenderTransform>
                <TextBlock l:Uids.Uid="GettingReadyTitleTextBlock" Style="{StaticResource TitleTextBlockStyle}"/>
                <RichTextBlock Margin="0 15" TextWrapping="Wrap" HorizontalAlignment="Left" IsTextSelectionEnabled="False">
                    <Paragraph>
                        <Run l:Uids.Uid="GettingReadyTextBlock"/>
                    </Paragraph>
                </RichTextBlock>
            </StackPanel>
            <StackPanel x:Name="LetsBeginStackPanel" Visibility="Collapsed" Grid.Row="1">
                <StackPanel.RenderTransform>
                    <TranslateTransform x:Name="LetsBegin_TT" />
                </StackPanel.RenderTransform>
                <TextBlock l:Uids.Uid="CreateNewConfigViaGoodCheckTextBlock" Style="{StaticResource TitleTextBlockStyle}" />
                <RichTextBlock Margin="15" TextWrapping="Wrap" MaxWidth="300" HorizontalAlignment="Left" IsTextSelectionEnabled="False">
                    <Paragraph>
                        <Run l:Uids.Uid="GoodCheckWizardTip"/>
                    </Paragraph>
                    <Paragraph Margin="0 20 0 0">
                        <Run l:Uids.Uid="ClickNextToBegin"/>
                    </Paragraph>
                </RichTextBlock>
            </StackPanel>
            <StackPanel x:Name="GoodCheckSettingsStackPanel" Visibility="Collapsed" Grid.Row="1" Margin="0 0 0 20">
                <StackPanel.RenderTransform>
                    <TranslateTransform x:Name="GoodCheck_TT" />
                </StackPanel.RenderTransform>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition x:Name="GridContentRowDefinition" Height="*"/>
                    </Grid.RowDefinitions>
                    <StackPanel x:Name="GoodCheckSettingsTextContent">
                        <TextBlock l:Uids.Uid="GoodCheckSelectSiteListsTitle" Style="{StaticResource TitleTextBlockStyle}"/>
                        <RichTextBlock Margin="0 15" TextWrapping="Wrap" HorizontalAlignment="Left" IsTextSelectionEnabled="False" Grid.Row="1">
                            <Paragraph>
                                <Run l:Uids.Uid="GoodCheckSelectSiteLists"/>
                            </Paragraph>
                        </RichTextBlock>
                        <Grid x:Name="SitelistActionPanelGrid" Grid.Row="2" Margin="0 0 0 10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Spacing="10" Grid.Column="0">
                                <Button>
                                    <Button.Content>
                                        <StackPanel Orientation="Horizontal" Spacing="10">
                                            <FontIcon Glyph="&#xE710;" FontSize="16"/>
                                            <TextBlock l:Uids.Uid="GoodCheckAddSiteList"/>
                                        </StackPanel>
                                    </Button.Content>
                                    <Button.Flyout>
                                        <Flyout x:Name="SelectSiteListFlyout">
                                            <StackPanel Width="370">
                                                <TextBlock l:Uids.Uid="GoodCheckSelectSiteListFromTemplate"/>
                                                <ScrollViewer MaxHeight="300" Margin="0 10 0 0">
                                                    <StackPanel x:Name="SiteListTemplatesStackPanel" Spacing="5"/>
                                                </ScrollViewer>
                                                <TextBlock l:Uids.Uid="ORSeparatorTextBlock" FontWeight="Bold" HorizontalAlignment="Center" Margin="10"/>
                                                <StackPanel Orientation="Horizontal" Spacing="10">
                                                    <Button x:Name="CreateNewFileButton" Width="120" Height="120" Padding="6" IsEnabled="False">
                                                        <Button.Content>
                                                            <StackPanel>
                                                                <FontIcon Glyph="&#xE8E5;" />
                                                                <TextBlock l:Uids.Uid="CreateNewTextBlock" TextWrapping="Wrap" TextAlignment="Center"/>
                                                            </StackPanel>
                                                        </Button.Content>
                                                    </Button>
                                                    <Button x:Name="ChooseFileButton" Width="120" Height="120" Padding="6" Click="ChooseFileButton_Click">
                                                        <Button.Content>
                                                            <StackPanel>
                                                                <FontIcon Glyph="&#xE8E5;" />
                                                                <TextBlock l:Uids.Uid="ChooseExistOnLocalPCTextBlock" TextWrapping="Wrap" TextAlignment="Center"/>
                                                            </StackPanel>
                                                        </Button.Content>
                                                    </Button>
                                                </StackPanel>
                                            </StackPanel>
                                        </Flyout>
                                    </Button.Flyout>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                    <ScrollViewer x:Name="SelectedSitelistScrollViewer" VerticalAlignment="Stretch" Grid.Row="1" 
                                  LayoutUpdated="SelectedSitelistScrollViewer_LayoutUpdated">
                        <StackPanel x:Name="SelectedSitelistStackPanel" Spacing="10" Margin="0 0" 
                                    VerticalAlignment="Stretch"
                                    LayoutUpdated="SelectedSitelistStackPanel_LayoutUpdated">
                            <StackPanel.ChildrenTransitions>
                                <TransitionCollection>
                                    <EntranceThemeTransition IsStaggeringEnabled="False" />
                                    <RepositionThemeTransition/>
                                </TransitionCollection>
                            </StackPanel.ChildrenTransitions>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <StackPanel x:Name="SelectedSitelistTip" VerticalAlignment="Center" Grid.Row="1">
                        <TextBlock l:Uids.Uid="GoodCheckEmptySiteListsTip1" HorizontalAlignment="Center" />
                        <TextBlock l:Uids.Uid="GoodCheckEmptySiteListsTip2" HorizontalAlignment="Center" />
                    </StackPanel>
                    
                </Grid>
            </StackPanel>

            <StackPanel x:Name="ChooseStrategiesListStackPanel" Grid.Row="1" Visibility="Collapsed">
                <StackPanel.RenderTransform>
                    <TranslateTransform x:Name="ChooseStrategiesList_TT" />
                </StackPanel.RenderTransform>
                <StackPanel x:Name="ChooseStrategiesListTextContent">
                    <TextBlock l:Uids.Uid="GoodCheckStrategyListChooseTitle" Style="{StaticResource TitleTextBlockStyle}"/>
                    <RichTextBlock Margin="0 15" TextWrapping="Wrap" HorizontalAlignment="Left" IsTextSelectionEnabled="False" Grid.Row="1">
                        <Paragraph>
                            <Run l:Uids.Uid="GoodCheckStrategyListChooseTip1"/>
                        </Paragraph>
                        <Paragraph Margin="0 10 0 0">
                            <Run l:Uids.Uid="GoodCheckStrategyListChooseTip2"/>
                        </Paragraph>
                    </RichTextBlock>

                    <CheckBox l:Uids.Uid="GoodCheckSelectSeparatelly" x:Name="ChangeModeComboBox" Click="ChangeModeComboBox_Click"/>
                </StackPanel>
                <StackPanel x:Name="AllListsOneStrategyPanel">
                    <controls:SettingsCard l:Uids.Uid="GoodCheckStrategyListChooseSettingCard">
                        <ComboBox x:Name="StrategiesListCombobox" Width="350" DisplayMemberPath="Name" SelectionChanged="StrategiesListCombobox_SelectionChanged"/>
                    </controls:SettingsCard>
                </StackPanel>
                <ScrollViewer x:Name="OneListOneStrategyScrollViewer" LayoutUpdated="OneListOneStrategyScrollViewer_LayoutUpdated">
                    <StackPanel x:Name="OneListOneStrategyStackPanel" Visibility="Collapsed" Spacing="5">
                        <StackPanel.ChildrenTransitions>
                            <TransitionCollection>
                                <EntranceThemeTransition IsStaggeringEnabled="False" />
                                <RepositionThemeTransition/>
                            </TransitionCollection>
                        </StackPanel.ChildrenTransitions>
                    </StackPanel>
                </ScrollViewer>
            </StackPanel>

            <StackPanel x:Name="AdditionalSettingsStackPanel" Grid.Row="1" Visibility="Collapsed">
                <StackPanel.RenderTransform>
                    <TranslateTransform/>
                </StackPanel.RenderTransform>
                <StackPanel x:Name="AdditionalSettingsListTextContent">
                    <TextBlock l:Uids.Uid="AdditionalSettings" Style="{StaticResource TitleTextBlockStyle}"/>
                    <RichTextBlock Margin="0 15" TextWrapping="Wrap" HorizontalAlignment="Left" IsTextSelectionEnabled="False" Grid.Row="1">
                        <Paragraph>
                            <Run l:Uids.Uid="GoodCheckAdditionalSettingsTip"/>
                        </Paragraph>
                    </RichTextBlock>
                </StackPanel>
                <ScrollViewer x:Name="AdditionalSettingsScrollViewer" LayoutUpdated="AdditionalSettingsScrollViewer_LayoutUpdated">
                    <StackPanel Spacing="5">
                        <TextBlock l:Uids.Uid="BasicTextBlock" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                        <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/TimeOut">
                            <controls:SettingsCard.Content>
                                <TextBox x:Name="ConnectionTimeout" MaxWidth="100"/>
                            </controls:SettingsCard.Content>
                        </controls:SettingsCard>
                        <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/TestCount">
                            <controls:SettingsCard.Content>
                                <TextBox x:Name="PValue" MaxWidth="100"/>
                            </controls:SettingsCard.Content>
                        </controls:SettingsCard>
                        <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/Resolver">
                            <controls:SettingsCard.Content>
                                <ComboBox x:Name="ResolverComboBox" SelectedIndex="0" SelectionChanged="ResolverComboBox_SelectionChanged" DisplayMemberPath="DisplayName"/>
                            </controls:SettingsCard.Content>
                        </controls:SettingsCard>

                        <ToggleButton x:Name="AdvansedToggleButton" >
                            <ToggleButton.Content>
                                <StackPanel Orientation="Horizontal" Spacing="5">
                                    <FontIcon Glyph="&#xE70D;" FontSize="16"/>
                                    <TextBlock l:Uids.Uid="ShowMoreSettings"/>
                                </StackPanel>
                            </ToggleButton.Content>
                        </ToggleButton>
                        
                        <StackPanel x:Name="AdditionalHideableSettingsStackPanel" 
                                    Spacing="5" 
                                    Visibility="{Binding IsChecked, ElementName=AdvansedToggleButton, Converter={StaticResource BoolToVis}}">
                            <TextBlock l:Uids.Uid="/GoodCheckAdditionalSettings/RequestsTextBlock" Style="{ThemeResource BodyStrongTextBlockStyle}" />
                            <StackPanel x:Name="NativeSettings" Spacing="5">
                                <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/ResolverTimeout">
                                    <controls:SettingsCard.Content>
                                        <TextBox x:Name="ResolverNativeTimeout" MaxWidth="100"/>
                                    </controls:SettingsCard.Content>
                                </controls:SettingsCard>
                                <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/ResolverRetryCount">
                                    <controls:SettingsCard.Content>
                                        <TextBox x:Name="ResolverNativeRetries" MaxWidth="100"/>
                                    </controls:SettingsCard.Content>
                                </controls:SettingsCard>
                            </StackPanel>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/InternalTimeout">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="InternalTimeoutMs" MaxWidth="100"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/AutomaticConnectivityTestTextBlock">
                                <controls:SettingsCard.Content>
                                    <ToggleSwitch x:Name="AutomaticConnectivityTest" />
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/ConnectivityTestURLs" Visibility="{Binding IsOn, ElementName=AutomaticConnectivityTest, Converter={StaticResource BoolToVis}}">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="ConnectivityTestURL" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/SkipCertVerifys">
                                <controls:SettingsCard.Content>
                                    <ToggleSwitch x:Name="SkipCertVerify" />
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>

                            <TextBlock l:Uids.Uid="/GoodCheckAdditionalSettings/AddressTextBlock" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/GGC">
                                <controls:SettingsCard.Content>
                                    <ToggleSwitch x:Name="AutomaticGoogleCacheTest" />
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>

                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/GGCAddr" Visibility="{Binding IsOn, ElementName=AutomaticGoogleCacheTest, Converter={StaticResource BoolToVis}}">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="GoogleCacheMappingURLs" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <TextBlock Style="{ThemeResource BodyStrongTextBlockStyle}" Text="DoH резолверы"/>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/UseDOH">
                                <controls:SettingsCard.Content>
                                    <ToggleSwitch x:Name="UseDoH" />
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/DOHResolvers"
                                               Visibility="{Binding IsOn, ElementName=UseDoH, Converter={StaticResource BoolToVis}}">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="DoHResolvers" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>

                            <TextBlock Style="{ThemeResource BodyStrongTextBlockStyle}" Text="Fakes"/>

                            <controls:SettingsCard Header="FAKE SNI">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="FakeSNI" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard Header="FAKE Hex Stream TCP">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="FakeHexStreamTCP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard Header="FAKE Hex Stream UDP">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="FakeHexStreamUDP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard Header="FAKE Hex Bytes TCP">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="FakeHexBytesTCP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard Header="FAKE Hex Bytes UDP">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="FakeHexBytesUDP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/Bin" Header="PayloadTCP" >
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="PayloadTCP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                            <controls:SettingsCard l:Uids.Uid="/GoodCheckAdditionalSettings/Bin" Header="PayloadUDP">
                                <controls:SettingsCard.Content>
                                    <TextBox x:Name="PayloadUDP" MaxWidth="350"/>
                                </controls:SettingsCard.Content>
                            </controls:SettingsCard>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </StackPanel>
            
        </Grid>

        <Grid x:Name="LoadingStateGrid" Grid.Row="1" Visibility="Collapsed">
            <StackPanel>
                <TextBlock l:Uids.Uid="WorkingOnItTextBlock" x:Name="LoadingHeader" Margin="20 0 0 5"/>
                <ProgressBar x:Name="LoadingProgressBar" IsIndeterminate="True" VerticalAlignment="Top" CornerRadius="0"/>
            </StackPanel>
        </Grid>
        <Grid x:Name="ActionButtonsGrid" Grid.Row="2">
            <Rectangle Fill="{ThemeResource ControlFillColorSecondaryBrush}"/>
            
            <Grid Padding="20">
                <Button l:Uids.Uid="GetHelpButton" x:Name="GetHelpButton" Padding="6" Click="GetHelpButton_Click">
                    <Button.Content>
                        <FontIcon Glyph="&#xE897;" FontSize="16"/>
                    </Button.Content>
                </Button>
                <StackPanel Orientation="Horizontal" Spacing="10"  HorizontalAlignment="Right">
                    <Button l:Uids.Uid="CancelButton" x:Name="CancelButton" MinWidth="150" Click="CancelButton_Click" IsEnabled="False"/>
                    <Button l:Uids.Uid="GoBackButton" x:Name="GoBackButton" MinWidth="150" Click="GoBackButton_Click"/>
                    <Button l:Uids.Uid="GoForwardButton" x:Name="GoForwardButton" Style="{StaticResource AccentButtonStyle}" MinWidth="150" Click="GoForwardButton_Click"/>
                </StackPanel>
            </Grid>
        </Grid>
        <InfoBar
            l:Uids.Uid="SiteListFileError"
            x:Name="FileIncorrectWarning"
            IsOpen="False"
            Severity="Warning"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Margin="0 0 20 20"
            Opacity="0"
            Loaded="FileIncorrectWarning_Loaded"
            Closing="FileIncorrectWarning_Closing">
            
            <InfoBar.RenderTransform>
                <TranslateTransform x:Name="InfoBarTranslate" X="200"/>
            </InfoBar.RenderTransform>
            
            <InfoBar.Resources>
                <Storyboard x:Name="OpenStoryboard">
                    <DoubleAnimation Storyboard.TargetName="InfoBarTranslate"
                           Storyboard.TargetProperty="X"
                           From="200" To="0" Duration="0:0:0.32"
                           EasingFunction="{StaticResource CubicEaseOut}" />
                    <DoubleAnimation Storyboard.TargetName="FileIncorrectWarning"
                           Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.20" />
                </Storyboard>

                <Storyboard x:Name="CloseStoryboard" Completed="CloseStoryboard_Completed">
                    <DoubleAnimation Storyboard.TargetName="InfoBarTranslate"
                           Storyboard.TargetProperty="X"
                           From="0" To="200" Duration="0:0:0.24"
                           EasingFunction="{StaticResource CubicEaseIn}" />
                    <DoubleAnimation Storyboard.TargetName="FileIncorrectWarning"
                           Storyboard.TargetProperty="Opacity"
                           From="1" To="0" Duration="0:0:0.18" />
                </Storyboard>
            </InfoBar.Resources>
        </InfoBar>
    </Grid>
</Page>
