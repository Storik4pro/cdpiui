<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="CDPI_UI.CriticalErrorHandlerWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CDPI_UI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Error Handler"
    xmlns:animatedvisuals="using:Microsoft.UI.Xaml.Controls.AnimatedVisuals">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid x:Name="AppTitleBar"
              Canvas.ZIndex="1"
              Height="48"
              IsHitTestVisible="True"
              VerticalAlignment="Top"
              Margin="8, 0, 0, 0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid x:Name="WindowMoveAera" Grid.Column="1" Margin="8, 0, 0, 0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <Image Source="/Assets/StoreLogo.png"
                       HorizontalAlignment="Left"
                       Width="16" Height="16"
                       Margin="0,0" Grid.Column="1"/>
                <TextBlock x:Name="AppTitleTextBlock" Text="CDPI UI Error Handler"
                           TextWrapping="NoWrap"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           VerticalAlignment="Center"
                           Grid.Column="2" Margin="18, 0, 0, 0"/>
            </Grid>
        </Grid>
        <Grid Margin="0 48 0 0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>
            <Grid x:Name="ContentGrid" Padding="20 20 0 20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <FontIcon Glyph="&#xEB90;" FontSize="80" VerticalAlignment="Top" Margin="0 0 20 0" Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
                <ScrollViewer Grid.Column="1" Padding="0 0 20 0">
                    <StackPanel Spacing="5">
                        <TextBlock Text="Something went wrong" Style="{ThemeResource TitleTextBlockStyle}"/>
                        <StackPanel Spacing="1">
                            <TextBlock Text="Where:"/>
                            <TextBlock x:Name="WhereTextBlock" Margin="20 0 0 0" Text="UNKNOWN" TextWrapping="Wrap" IsTextSelectionEnabled="True"/>
                        </StackPanel>
                        <StackPanel Spacing="1">
                            <TextBlock Text="Why:"/>
                            <TextBlock x:Name="WhyTextBlock" Margin="20 0 0 0" Text="This information not provided." TextWrapping="Wrap" IsTextSelectionEnabled="True"/>
                        </StackPanel>
                        <StackPanel Spacing="1">
                            <TextBlock Text="Error Code:"/>
                            <TextBlock x:Name="ErrorCodeTextBlock" Margin="20 0 0 0" Text="ERR_FLASHLIGHT_BUSY" TextWrapping="Wrap" IsTextSelectionEnabled="True"/>
                        </StackPanel>
                        <StackPanel Spacing="1">
                            <TextBlock Text="Additional information:"/>
                            <TextBlock x:Name="AdditionalTextBlock" Margin="20 0 0 0" Text="This information not provided." TextWrapping="Wrap" IsTextSelectionEnabled="True"/>
                        </StackPanel>

                        <TextBlock Text="If this error persists, please contact app support and report the issue." FontStyle="Italic" Margin="0 20 0 0"/>
                        <HyperlinkButton x:Name="OpenLogFolder" Content="View log folder" Padding="0" Click="OpenLogFolder_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
            <Grid x:Name="ActionButtonsGrid" Grid.Row="2">
                <Rectangle Fill="{ThemeResource ControlFillColorSecondaryBrush}"/>

                <Grid Padding="20">
                    <Button x:Name="GetHelpButton" ToolTipService.ToolTip="Report problem" Padding="6" Click="GetHelpButton_Click">
                        <Button.Content>
                            <FontIcon Glyph="&#xEBE8;" FontSize="16"/>
                        </Button.Content>
                    </Button>
                    <StackPanel Orientation="Horizontal" Spacing="10"  HorizontalAlignment="Right">
                        <Button x:Name="CopyButton" MinWidth="150" Click="CopyButton_Click">
                            <Button.Content>
                                <Grid>
                                    <StackPanel x:Name="CopyText" Orientation="Horizontal" Spacing="5">
                                        <FontIcon Glyph="&#xE8C8;" FontSize="16"/>
                                        <TextBlock Text="Copy"/>
                                    </StackPanel>
                                    <StackPanel x:Name="CopiedText" Orientation="Horizontal" Spacing="5" Visibility="Collapsed">
                                        <FontIcon Glyph="&#xE73E;" FontSize="16"/>
                                        <TextBlock Text="Copied"/>
                                    </StackPanel>
                                </Grid>
                            </Button.Content>
                        </Button>
                        <Button x:Name="ExitButton" Content="OK" MinWidth="150" Click="ExitButton_Click"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>
