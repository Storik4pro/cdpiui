<?xml version="1.0" encoding="utf-8"?>
<ex:WindowEx
    x:Class="CDPI_UI.Messages.StoreLocalItemInstallingDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CDPI_UI.Messages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:ex="using:WinUIEx"
    xmlns:l="using:WinUI3Localizer"
    xmlns:labs="using:CommunityToolkit.Labs.WinUI"
    Title="StoreLocalItemInstallingDialog">

    <ex:WindowEx.SystemBackdrop>
        <MicaBackdrop />
    </ex:WindowEx.SystemBackdrop>

    <Grid>
        <Grid x:Name="AppTitleBar"
          Canvas.ZIndex="1"
          Height="48"
          IsHitTestVisible="True"
          VerticalAlignment="Top"
          Margin="0, 0, 0, 0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Grid x:Name="WindowMoveAera" Grid.Column="1" Margin="0, 0, 0, 0" Padding="0, 0, 0, 0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <Image Source="/Assets/StoreLogo.png"
                   HorizontalAlignment="Left"
                   Width="16" Height="16"
                   Margin="16 0 0 0" Grid.Column="1"/>
                <TextBlock 
                l:Uids.Uid="StoreWindowTitleTextBlock"
                x:Name="AppTitleTextBlock"
                TextWrapping="NoWrap"
                Style="{StaticResource CaptionTextBlockStyle}"
                VerticalAlignment="Center"
                Grid.Column="2" Margin="18, 0, 0, 0"/>
            </Grid>
        </Grid>
        <Grid x:Name="ContentFrame" Margin="0,48,0,0" Padding="20 5 20 20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="100"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Column="0">
                <Grid>
                    <TextBlock x:Name="ItemNameTextBlock" Style="{ThemeResource TitleTextBlockStyle}"/>
                    <labs:Shimmer x:Name="TitleShimmer" Visibility="Visible" Width="300" HorizontalAlignment="Left" Margin="0 2"/>
                </Grid>
                <Grid>
                    <TextBlock x:Name="DeveloperTextBlock"/>
                    <labs:Shimmer x:Name="DeveloperShimmer" Visibility="Visible" Width="200" HorizontalAlignment="Left" Margin="0 2"/>
                </Grid>
                <Grid>
                    <TextBlock x:Name="VersionTextBlock"/>
                    <labs:Shimmer x:Name="VersionShimmer" Visibility="Visible" Width="150" HorizontalAlignment="Left" Margin="0 2"/>
                </Grid>
                <Grid>
                    <TextBlock x:Name="CategoryTextBlock" TextWrapping="Wrap" MaxLines="2"/>
                    <labs:Shimmer x:Name="CategoryShimmer" Visibility="Visible" Width="150" HorizontalAlignment="Left" Margin="0 2"/>
                </Grid>
            </StackPanel>

            <Grid x:Name="ImageGrid" Grid.Column="1" Width="90" Height="90" VerticalAlignment="Top">
                <Rectangle Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Fill="{ThemeResource AccentAcrylicBackgroundFillColorDefaultBrush}"/>
                <Rectangle x:Name="ItemColorRectangle" Grid.Column="0" 
                       HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                
                <Image x:Name="ItemImage" Width="60" VerticalAlignment="Center"/>
                <labs:Shimmer x:Name="ImageShimmer" Visibility="Visible"/>
            </Grid>

            <Grid x:Name="ItemSmallDescriptionStackPanel" Grid.Row="1" Grid.ColumnSpan="2" Margin="0 10">
                <TextBlock x:Name="ItemSmallDescriptionTextBlock" TextWrapping="Wrap"/>
                <StackPanel x:Name="DescriptionShimmer" Spacing="5">
                    <labs:Shimmer Visibility="Visible" Width="350" Height="15" HorizontalAlignment="Left"/>
                    <labs:Shimmer Visibility="Visible" Width="150" Height="15" HorizontalAlignment="Left"/>
                    <labs:Shimmer Visibility="Visible" Width="200" Height="15" HorizontalAlignment="Left"/>
                </StackPanel>
            </Grid>

            <Grid x:Name="ErrorGrid" Grid.Row="2" Grid.ColumnSpan="2" Margin="0 10" CornerRadius="0" Visibility="Collapsed" BorderThickness="3" BorderBrush="{ThemeResource AccentAcrylicBackgroundFillColorDefaultBrush}">
                <Grid Padding="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition Width="5"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <FontIcon Glyph="&#xEB90;" Foreground="{ThemeResource SystemFillColorCriticalBrush}" VerticalAlignment="Top"/>
                    <StackPanel Grid.Column="2">
                        <TextBlock l:Uids.Uid="CannotInstallItemTextBlock" Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                        <TextBlock x:Name="ErrorCodeTextBlock" IsTextSelectionEnabled="True" TextWrapping="Wrap"/>
                    </StackPanel>
                </Grid>
            </Grid>

            <StackPanel x:Name="DownloadProgressStackPanel" Grid.Row="3" Grid.ColumnSpan="2" Padding="0 10" Visibility="Collapsed">
                <StackPanel Orientation="Horizontal" Spacing="10">
                    <TextBlock x:Name="CurrentStatusTextBlock" Text="Getting ready..."/>
                    <TextBlock x:Name="CurrentStatusSpeedTextBlock"/>
                </StackPanel>
                <ProgressBar x:Name="StatusProgressbar" IsIndeterminate="True"/>
            </StackPanel>
            <Grid x:Name="ActionGrid" Grid.Row="4" Grid.ColumnSpan="2" >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="auto"/>
                </Grid.ColumnDefinitions>
                <HyperlinkButton x:Name="ViewInStoreButton" Click="ViewInStoreButton_Click" Padding="0" VerticalAlignment="Bottom">
                    <StackPanel Orientation="Horizontal" Spacing="5">
                        <TextBlock l:Uids.Uid="ViewInStoreTextBlock"/>
                        <FontIcon Glyph="&#xE8A7;" FontSize="16"/>
                    </StackPanel>
                </HyperlinkButton>
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                    <Button x:Name="GetButton" Width="120" l:Uids.Uid="InstallButton" Style="{ThemeResource AccentButtonStyle}" Click="GetButton_Click"/>
                    <Button x:Name="CancelButton" Width="120" l:Uids.Uid="CancelButton" Style="{ThemeResource AccentButtonStyle}" Click="CancelButton_Click"/>
                </StackPanel>
            </Grid>
            <Grid x:Name="WarningGrid" Grid.Row="5" Grid.ColumnSpan="2" VerticalAlignment="Bottom">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <FontIcon Glyph="&#xE814;" FontSize="48" Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
                <TextBlock Grid.Column="2" l:Uids.Uid="ItemUnknownSourceWarningTextBlock" TextWrapping="Wrap"/>
            </Grid>
        </Grid>
    </Grid>
</ex:WindowEx>
